{
  "$schema": "https://the-aico.com/schema/employee.json",
  "name": "backend",
  "role": "Backend Engineer",
  "description": "Full-stack backend development: API design, database, business logic, TDD, and system architecture",
  "skills": [
    {
      "name": "init",
      "files": [
        {
          "path": "skills/init/SKILL.md",
          "type": "skill",
          "content": "---\nname: aico-backend-init\ndescription: |\n  Initialize backend environment by creating constraints document from template.\n\n  Use this skill when:\n  - Running /backend.init command\n  - User asks to \"initialize backend\", \"setup backend environment\"\n  - Starting backend work and need to establish tech stack and conventions\n  - Need to create docs/reference/backend/constraints.md\n---\n\n# Backend Init\n\nInitialize backend development environment by creating the constraints file.\n\n## Language Configuration\n\nBefore generating any content, check `aico.json` in project root for `language` field to determine the output language. If not set, default to English.\n\n## Process\n\n1. **Check existing**: Look for `docs/reference/backend/constraints.md`\n2. **If exists**: Ask user if they want to overwrite or skip\n3. **Create directory structure**:\n   ```\n   docs/reference/backend/\n   ├── constraints.md\n   └── tasks/\n   ```\n4. **Generate constraints file**:\n   - Read template from `references/constraints.template.md`\n   - Guide user through key decisions\n5. **Save output**: Write to `docs/reference/backend/constraints.md`\n\n## Document Header Format\n\nAll generated documents MUST use this unified header format:\n\n```markdown\n# [Document Title]\n\n> Project: [project-name]\n> Created: YYYY-MM-DD\n> Last Updated: YYYY-MM-DD\n```\n\n## Guided Questions\n\n| Category         | Questions                          |\n| ---------------- | ---------------------------------- |\n| Language/Runtime | Node.js, Python, Go, Rust?         |\n| Framework        | Express, Fastify, FastAPI, Gin?    |\n| Database         | PostgreSQL, MySQL, MongoDB?        |\n| ORM/Query        | Prisma, Drizzle, SQLAlchemy, GORM? |\n| Testing          | Vitest, Jest, Pytest, Go test?     |\n| API Style        | REST, GraphQL, gRPC?               |\n\n## Template\n\nSee `references/constraints.template.md` for the full constraints template.\n\n## Update Instructions File\n\nAfter creating constraint files, update the project's AI instructions file to reference them:\n\n1. **Check for existing instructions file**:\n   - Look for `CLAUDE.md` (Claude Code) or `AGENTS.md` (Codex) in project root\n   - If neither exists, create `CLAUDE.md`\n\n2. **Add reference section** at the end of the file:\n\n   ```markdown\n   ## Reference Documents\n\n   The following constraint documents should be read before starting work:\n\n   - `docs/reference/backend/constraints.md` - Tech stack and coding conventions\n   ```\n\n3. **If file already has Reference Documents section**: Append the new reference if not already present\n\n## Output\n\n```\n✓ Created docs/reference/backend/constraints.md\n✓ Created docs/reference/backend/tasks/\n✓ Updated CLAUDE.md with reference to constraint files\n✓ Backend environment initialized\n```\n\n## Key Rules\n\n- ALWAYS use the unified header format\n- MUST guide user through tech stack questions\n- ALWAYS create tasks/ directory\n- ALWAYS save to `docs/reference/backend/constraints.md`\n- MUST update CLAUDE.md or AGENTS.md with reference to constraint files\n"
        },
        {
          "path": "skills/init/references/constraints.template.md",
          "type": "doc",
          "content": "# Backend Constraints\n\n> Project: [PROJECT_NAME]\n> Created: [CREATED_DATE]\n> Last Updated: [UPDATED_DATE]\n\n## Tech Stack\n\n### Language & Runtime\n\n| Item            | Value                                 |\n| --------------- | ------------------------------------- |\n| Language        | TypeScript / Python / Go              |\n| Runtime         | Node.js 20+ / Python 3.11+ / Go 1.21+ |\n| Package Manager | pnpm / npm / pip / go mod             |\n\n### Framework\n\n| Item          | Value                                    |\n| ------------- | ---------------------------------------- |\n| Web Framework | Express / Fastify / FastAPI / Gin        |\n| Validation    | Zod / Pydantic / go-playground/validator |\n| ORM/Query     | Prisma / Drizzle / SQLAlchemy / GORM     |\n\n### Database\n\n| Item       | Value                                     |\n| ---------- | ----------------------------------------- |\n| Primary DB | PostgreSQL / MySQL / MongoDB              |\n| Cache      | Redis / Memcached                         |\n| Migrations | Prisma Migrate / Alembic / golang-migrate |\n\n## Architecture\n\n### API Style\n\n- [ ] REST\n- [ ] GraphQL\n- [ ] gRPC\n- [ ] WebSocket\n\n### Layered Architecture\n\n```\nController/Handler (HTTP layer)\n       ↓\n    Service (Business logic)\n       ↓\n   Repository (Data access)\n       ↓\n    Database\n```\n\n### Directory Structure\n\n```\nsrc/\n├── controllers/     # HTTP handlers\n├── services/        # Business logic\n├── repositories/    # Data access\n├── models/          # Database models\n├── types/           # TypeScript types/interfaces\n├── middleware/      # Express/Fastify middleware\n├── utils/           # Utility functions\n└── config/          # Configuration\n```\n\n## Coding Standards\n\n### Naming Conventions\n\n| Type            | Convention  | Example           |\n| --------------- | ----------- | ----------------- |\n| Files           | kebab-case  | `user-service.ts` |\n| Classes         | PascalCase  | `UserService`     |\n| Functions       | camelCase   | `createUser`      |\n| Constants       | UPPER_SNAKE | `MAX_RETRIES`     |\n| Database tables | snake_case  | `user_sessions`   |\n\n### Code Style\n\n- Use ESLint/Prettier (TS), Ruff (Python), golangci-lint (Go)\n- Max line length: 100 characters\n- Use async/await over callbacks\n- Explicit error handling (no silent failures)\n\n## Testing\n\n### Framework\n\n| Type        | Tool                             |\n| ----------- | -------------------------------- |\n| Unit Tests  | Jest / Vitest / Pytest / Go test |\n| Integration | Supertest / httptest             |\n| Mocking     | jest.mock / unittest.mock        |\n\n### Requirements\n\n- [ ] All services must have unit tests\n- [ ] All API endpoints must have integration tests\n- [ ] Minimum 80% code coverage\n- [ ] TDD: Write failing test before implementation\n\n### Test Structure\n\n```\nsrc/\n├── services/\n│   ├── user.service.ts\n│   └── __tests__/\n│       └── user.service.test.ts\n```\n\n## Security\n\n### Authentication\n\n- [ ] JWT tokens\n- [ ] Session-based\n- [ ] OAuth 2.0\n- [ ] API keys\n\n### Password Handling\n\n- Use bcrypt with cost factor 10+\n- Never store plaintext passwords\n- Never log passwords\n\n### Input Validation\n\n- Validate all inputs at API boundary\n- Use schema validation (Zod/Pydantic)\n- Sanitize user inputs\n\n### OWASP Top 10\n\n- [ ] SQL Injection: Use parameterized queries\n- [ ] XSS: Escape output, use Content-Security-Policy\n- [ ] CSRF: Use CSRF tokens for state-changing operations\n- [ ] Auth: Secure session management\n\n## Error Handling\n\n### Error Response Format\n\n```json\n{\n  \"error\": {\n    \"code\": \"VALIDATION_ERROR\",\n    \"message\": \"Email is required\",\n    \"details\": [...]\n  }\n}\n```\n\n### HTTP Status Codes\n\n| Code | Usage                          |\n| ---- | ------------------------------ |\n| 200  | Success                        |\n| 201  | Created                        |\n| 400  | Bad Request (validation error) |\n| 401  | Unauthorized                   |\n| 403  | Forbidden                      |\n| 404  | Not Found                      |\n| 500  | Internal Server Error          |\n\n## Logging\n\n### Format\n\n```json\n{\n  \"timestamp\": \"2024-01-01T00:00:00Z\",\n  \"level\": \"info\",\n  \"message\": \"User created\",\n  \"context\": { \"userId\": \"123\" }\n}\n```\n\n### Levels\n\n| Level | Usage                        |\n| ----- | ---------------------------- |\n| error | Errors requiring attention   |\n| warn  | Warnings, degraded operation |\n| info  | Normal operations            |\n| debug | Debugging information        |\n\n## Environment\n\n### Required Variables\n\n```bash\n# Database\nDATABASE_URL=postgresql://...\n\n# Auth\nJWT_SECRET=...\nJWT_EXPIRY=3600\n\n# Server\nPORT=3000\nNODE_ENV=development\n```\n\n### Configuration\n\n- Use environment variables for secrets\n- Use config files for non-sensitive settings\n- Never commit secrets to git\n\n## API Design\n\n### REST Conventions\n\n| Method | Path       | Action      |\n| ------ | ---------- | ----------- |\n| GET    | /users     | List users  |\n| GET    | /users/:id | Get user    |\n| POST   | /users     | Create user |\n| PUT    | /users/:id | Update user |\n| DELETE | /users/:id | Delete user |\n\n### Pagination\n\n```json\n{\n  \"data\": [...],\n  \"pagination\": {\n    \"page\": 1,\n    \"limit\": 20,\n    \"total\": 100\n  }\n}\n```\n\n## Performance\n\n### Database\n\n- Use indexes for frequently queried columns\n- Avoid N+1 queries\n- Use connection pooling\n\n### Caching\n\n- Cache frequently accessed data\n- Set appropriate TTL\n- Invalidate on updates\n\n### Rate Limiting\n\n- Implement rate limiting for public APIs\n- Use sliding window algorithm\n- Return 429 Too Many Requests\n"
        }
      ]
    },
    {
      "name": "task-breakdown",
      "files": [
        {
          "path": "skills/task-breakdown/SKILL.md",
          "type": "skill",
          "content": "---\nname: aico-backend-task-breakdown\ndescription: |\n  Break down PM story into organized tasks in a single file following LAYERED ARCHITECTURE order: Types → Database → Repository → Service → API → Tests.\n\n  UNIQUE VALUE: Creates single task file (story-{name}.md) containing all tasks for a story. Tasks are ordered by backend architecture layers.\n\n  Use this skill when:\n  - Running /backend.tasks command\n  - User asks to \"break down story\", \"create backend tasks\", \"split into tasks\"\n  - Have story at docs/reference/pm/stories/ and need organized task breakdown\n  - Need tasks ordered by backend architecture layers (not random order)\n  - Starting backend work and want organized task list\n\n  Task order is CRITICAL: Setup → Static UI → Dynamic → Interactions → Tests\n  Output: Create single file docs/reference/backend/tasks/story-{name}.md with all tasks\n---\n\n# Task Breakdown\n\n## ⚠️ CRITICAL RULES - READ FIRST\n\n**BEFORE doing anything, you MUST:**\n\n1. **CHECK EXISTING TASK FILE FIRST**:\n   - ALWAYS check if `story-{story-name}.md` already exists in `docs/reference/backend/tasks/`\n   - If exists: READ it and continue from current progress (add new tasks or update existing ones)\n   - If not exists: Create new task breakdown file\n   - **NEVER re-break down existing tasks**\n\n2. **FILE NAMING**:\n   - Pattern: `story-{story-name}.md` (single file per story)\n   - Example: `story-user-profile.md`\n   - All tasks for this story go into this ONE file\n   - Tasks are separated by `---` dividers\n\n3. **MULTIPLE TASKS IN ONE FILE**:\n   - One file contains ALL tasks for the story\n   - Each task = independently testable section\n   - Clear scope and acceptance criteria per task\n   - Tasks numbered sequentially (Task 1, Task 2, etc.)\n\n4. **ALWAYS SAVE TO CORRECT PATH**:\n   - Path: `docs/reference/backend/tasks/story-{story-name}.md`\n   - NO exceptions, NO other locations\n\n5. **READ CONTEXT FIRST**:\n   - Read story from `docs/reference/pm/stories/`\n   - Read design from `docs/reference/backend/designs/` if exists\n   - Read design system from `docs/reference/backend/design-system.md`\n   - Read constraints from `docs/reference/backend/constraints.md`\n\n## Language Configuration\n\nBefore generating any content, check `aico.json` in project root for `language` field to determine the output language. If not set, default to English.\n\n## Process\n\n1. **Read story/PRD**: Load from `docs/reference/pm/stories/` or `docs/reference/pm/versions/`\n2. **Read design** (if exists): Load from `docs/reference/backend/designs/`\n3. **Read constraints**: Load design system and technical constraints\n4. **Identify components**: What backend layers are needed\n5. **Identify interactions**: What APIs and data flows are needed\n6. **Break into tasks**: Independently testable, single responsibility, by architecture layer\n7. **Order by dependencies**: Types → DB → Repository → Service → API → Tests\n8. **Generate single file**: Create `story-{story-name}.md` with all tasks in sections\n9. **Update Story file**: Add \"Related Tasks\" section to story file with link to task file\n10. **Summary**: Show created file and next steps\n\n## Task File Format\n\nThe task breakdown creates a single file containing all tasks for the story:\n\n```markdown\n# Story Tasks: [Story Name]\n\n> **Story**: docs/reference/pm/stories/{story-id}.md\n> **Design**: docs/reference/backend/designs/{design-name}.md (if applicable)\n> **Role**: backend\n> **Created**: YYYY-MM-DD\n> **Updated**: YYYY-MM-DD\n\n---\n\n## Task 1: Define Types\n\n> **Status**: pending | in_progress | completed\n> **Type**: setup\n> **Depends on**: -\n> **Estimated**: 1-2h (optional)\n\n### Description\n\nDefine TypeScript types and interfaces for the feature.\n\n### Context\n\n- Part of [Story Name] story\n- First task - establishes data contracts\n- Foundation for all other backend tasks\n\n### Acceptance Criteria\n\n- [ ] Define request/response types\n- [ ] Define domain model types\n- [ ] Export types from types module\n\n### Scope\n\n**Files to create/modify:**\n\n- Create: `src/types/...`\n- Modify: `src/types/index.ts`\n\n### Implementation Steps\n\n> Note: Detailed steps can be added using `/backend.plan` command\n\n1. [Brief step description]\n2. [Brief step description]\n\n### Notes\n\n[Any additional notes]\n\n---\n\n## Task 2: Database Schema\n\n> **Status**: pending\n> **Type**: feature\n> **Depends on**: Task 1\n\n### Description\n\nCreate database schema and migrations for the feature.\n\n### Context\n\n- Part of [Story Name] story\n- Depends on: Task 1 (types must be defined)\n- Implements data persistence layer\n\n### Acceptance Criteria\n\n- [ ] Create migration files\n- [ ] Define table schemas\n- [ ] Add indexes and constraints\n\n### Scope\n\n**Files to create/modify:**\n\n- Create: `migrations/...`\n- Create: `src/db/schema/...`\n\n### Implementation Steps\n\n> Note: Add detailed steps using `/backend.plan story-{name}` and specify task number\n\n1. [Brief step description]\n\n### Notes\n\n[Any notes]\n\n---\n\n## Task 3: Repository Layer\n\n> **Status**: pending\n> **Type**: feature\n> **Depends on**: Task 2\n\n### Description\n\nImplement repository layer for data access.\n\n### Acceptance Criteria\n\n- [ ] Create repository class\n- [ ] Implement CRUD methods\n- [ ] Add query methods\n\n### Scope\n\n**Files to create:**\n\n- `src/repositories/...`\n\n---\n\n## Task 4: Service Layer\n\n> **Status**: pending\n> **Type**: feature\n> **Depends on**: Task 3\n\n### Description\n\nImplement business logic in service layer.\n\n### Acceptance Criteria\n\n- [ ] Create service class\n- [ ] Implement business rules\n- [ ] Handle error cases\n\n### Scope\n\n**Files to create:**\n\n- `src/services/...`\n\n---\n\n## Task 5: API Endpoints\n\n> **Status**: pending\n> **Type**: feature\n> **Depends on**: Task 4\n\n### Description\n\nCreate REST API endpoints for the feature.\n\n### Acceptance Criteria\n\n- [ ] Define routes\n- [ ] Implement controllers\n- [ ] Add validation middleware\n\n### Scope\n\n**Files to create/modify:**\n\n- Create: `src/api/routes/...`\n- Create: `src/api/controllers/...`\n\n---\n\n## Task 6: Add Tests\n\n> **Status**: pending\n> **Type**: testing\n> **Depends on**: Task 5\n\n### Description\n\nAdd comprehensive tests for all layers.\n\n### Acceptance Criteria\n\n- [ ] Unit tests for services\n- [ ] Integration tests for repositories\n- [ ] E2E tests for API endpoints\n- [ ] All tests passing\n\n### Scope\n\n**Files to create:**\n\n- `src/__tests__/...`\n\n---\n\n## Story Progress\n\n- Total tasks: 6\n- Completed: 0\n- In progress: 0\n- Pending: 6\n\n**Next task**: Task 1: Define Types\n```\n\n## Task Types\n\n| Type        | Examples                                |\n| ----------- | --------------------------------------- |\n| Setup       | Create component structure, setup state |\n| UI          | Implement section/component layout      |\n| Logic       | Add form validation, API integration    |\n| Interaction | Implement hover, click, animations      |\n| Testing     | Unit tests, integration tests           |\n\n## Granularity Rules\n\n- Each task = independently testable\n- Each task = single responsibility\n- Each task = clear scope (not too big, not too small)\n- Each task = 1-4 hours of work\n\n## Ordering Rules\n\n1. **Setup tasks first** - Component structure, routing\n2. **Static UI before dynamic** - Layout before logic\n3. **Core functionality before edge cases** - Happy path first\n4. **Tests after implementation** - Each feature gets tests\n\n## Updating Story File\n\nAfter generating the task file, **ALWAYS** update the story file to add the \"Related Tasks\" section:\n\n```markdown\n## Related Tasks\n\n### Backend Tasks\n\nTask breakdown: [docs/reference/backend/tasks/story-user-profile.md](../backend/tasks/story-user-profile.md)\n\n**Progress**: 0/6 tasks completed\n\n- [ ] Task 1: Define Types\n- [ ] Task 2: Database Schema\n- [ ] Task 3: Repository Layer\n- [ ] Task 4: Service Layer\n- [ ] Task 5: API Endpoints\n- [ ] Task 6: Add Tests\n```\n\n**Key points:**\n\n- Add this section at the end of the story file (before any existing notes)\n- Include link to the task file\n- Use `- [ ]` checkboxes for each task (will be checked when task completes)\n- List tasks in execution order (Types → DB → Repository → Service → API → Tests)\n- Keep the section organized by frontend/backend if both exist\n- Include progress counter (X/Y tasks completed)\n\n## Output Example\n\nAfter breaking down \"user-profile\" story:\n\n```\nCreated task file for story 'user-profile':\n\n✓ docs/reference/backend/tasks/story-user-profile.md\n\nTask breakdown includes:\n- Task 1: Define Types (setup)\n- Task 2: Database Schema (feature)\n- Task 3: Repository Layer (feature)\n- Task 4: Service Layer (feature)\n- Task 5: API Endpoints (feature)\n- Task 6: Add Tests (testing)\n\nTotal: 6 tasks\n\nNext steps:\n1. Review task breakdown in story-user-profile.md\n2. Use /backend.plan to add detailed steps to specific tasks\n3. Use /backend.implement to start executing tasks\n```\n\n## Key Rules\n\n- ALWAYS create a single file containing all tasks for the story\n- MUST use `story-{story-name}.md` naming (NOT multiple files)\n- ALWAYS include test tasks at the end\n- MUST note dependencies between tasks (in each task's metadata)\n- Keep tasks focused - not too big, not too small\n- Each task section is self-contained with clear acceptance criteria\n- Separate tasks with `---` dividers\n- Include Story Progress section at the end of file\n\n## Common Mistakes\n\n- ❌ Tasks too large (full feature) → ✅ Break into layers\n- ❌ Tasks too small (add one field) → ✅ Group related work\n- ❌ Skip dependencies → ✅ Note which tasks depend on others\n- ❌ Forget testing → ✅ Always include test tasks\n- ❌ Create multiple files → ✅ Use single file with multiple task sections\n"
        }
      ]
    },
    {
      "name": "plan",
      "files": [
        {
          "path": "skills/plan/SKILL.md",
          "type": "skill",
          "content": "---\nname: aico-backend-plan\ndescription: |\n  Create or enhance backend tasks with detailed implementation steps. Supports TWO modes:\n\n  MODE A: Enhance existing task (add detailed steps to task in file)\n  MODE B: Create new standalone task file (can contain single or multiple tasks)\n\n  IMPORTANT: This skill creates MICRO-LEVEL atomic steps, NOT macro architecture plans.\n  For architecture planning or feature scoping, use EnterPlanMode instead.\n\n  Use this skill when:\n  - Running /backend.plan command\n  - User asks for \"atomic steps\", \"step-by-step plan with verification\"\n  - Have a specific task and need implementation steps\n  - User wants to create a standalone task file (not from story)\n  - Need granular steps: Types → DB → Repository → Service → API → Tests\n\n  DO NOT use for:\n  - Architecture planning (use EnterPlanMode)\n  - General development planning\n  - Feature scoping or estimation\n\n  Output:\n  - MODE A: Update specific task section in file with Implementation Steps\n  - MODE B: Create new standalone-{name}.md file with one or multiple tasks\n---\n\n# Plan\n\n## ⚠️ CRITICAL RULES - READ FIRST\n\n1. **DETECT MODE**: Determine if input is an existing task reference or a new requirement description\n   - If input looks like `story-user-api Task 1` or `standalone-fix-auth Task 2`: **MODE A**\n   - If input is a new requirement (e.g., \"Add user authentication\"): **MODE B**\n\n2. **MODE A - Enhance Existing Task**:\n   - Read the task file from `docs/reference/backend/tasks/`\n   - User must specify task number (e.g., \"Task 1\", \"Task 2\")\n   - Add or update the \"Implementation Steps\" section for that specific task\n   - Keep all other sections intact\n   - Save back to the same file\n\n3. **MODE B - Create Standalone Task File**:\n   - Analyze the requirement - is it simple (1 task) or complex (multiple tasks)?\n   - If complex, break into multiple tasks (like task-breakdown does)\n   - Use filename: `standalone-{requirement-name}.md` (kebab-case)\n   - Save to `docs/reference/backend/tasks/`\n   - File format: same as story-based (multiple task sections)\n\n4. **READ CONSTRAINTS FIRST**:\n   - Must read `docs/reference/backend/design-system.md` for design tokens\n   - Must read `docs/reference/backend/constraints.md` for tech stack\n   - If task references a design, read from `docs/reference/backend/designs/`\n\n## Language Configuration\n\nBefore generating any content, check `aico.json` in project root for `language` field to determine the output language. If not set, default to English.\n\n## MODE A: Enhance Existing Task\n\n### Process\n\n1. **Read task file**: Get task details from `docs/reference/backend/tasks/{task-file}.md`\n2. **Read design** (if referenced): Load related design from `docs/reference/backend/designs/`\n3. **Read design system**: Load `docs/reference/backend/design-system.md` for design tokens\n4. **Read constraints**: Load `docs/reference/backend/constraints.md`\n5. **Break into atomic steps**:\n   - Start with file creation/setup\n   - One section/feature per step\n   - Include verification for each step\n   - Do NOT include commit step (that happens during execution)\n6. **Keep steps atomic**: One action per step\n7. **Update task file**: Add/replace \"Implementation Steps\" section\n8. **Present summary**: Show file location and what was added\n\n### Example\n\n```bash\n# Input: User runs /backend.plan story-user-profile-2-header\n\n# Output:\n✓ Read task: docs/reference/backend/tasks/story-user-profile-2-header.md\n✓ Added 4 implementation steps to task file\n\nSteps added:\n1. Create component file\n2. Implement header layout\n3. Add responsive styles\n4. Add unit tests\n\nTask ready for implementation. Use aico-backend-implement to execute.\n```\n\n## MODE B: Create Standalone Task\n\n### Process\n\n1. **Ask user for details**:\n   - Task type: feature | bugfix | improvement\n   - Confirm task name (auto-generate from description)\n\n2. **Read constraints**:\n   - Read design system and technical constraints\n   - If user mentions a component, check existing code\n\n3. **Generate complete task file**:\n   - All metadata (type, source, created, status)\n   - Description\n   - Context\n   - Acceptance Criteria\n   - Scope\n   - Implementation Steps (detailed, atomic)\n   - Notes\n\n4. **Save task file**: Write to `docs/reference/backend/tasks/standalone-{task-name}.md`\n\n5. **Present summary**: Show created file and next steps\n\n### Example\n\n```bash\n# Input: User runs /backend.plan \"Fix login button hover state\"\n\n# Interactive:\n# Type: [feature | bugfix | improvement] → bugfix\n# Task name: fix-login-button-hover (auto-generated, confirm?)\n\n# Output:\n✓ Created standalone task: standalone-fix-login-button-hover.md\n\nTask includes:\n- Description and context\n- 2 acceptance criteria\n- 3 implementation steps\n- Test verification\n\nNext: Use aico-backend-implement to execute this task\n```\n\n## Implementation Steps Format\n\nBoth modes use the same step format:\n\n````markdown\n## Implementation Steps\n\n### Step 1: [Action]\n\n**Files**:\n\n- Create: `src/components/[Name].tsx`\n- Modify: `src/pages/[Page].tsx:L10-L20`\n\n**Action**:\n[Exact code or action to take]\n\n**Verify**:\n\n```bash\n[verification command]\n```\n````\n\nExpected: [expected output]\n\n---\n\n### Step 2: [Next Action]\n\n...\n\n````\n\n## Step Granularity\n\nEach step = ONE atomic action:\n\n| Good Steps | Bad Steps |\n|------------|-----------|\n| Create component file with imports | Create component with all logic |\n| Add component skeleton (empty return) | Implement entire component |\n| Implement single section | Implement all sections |\n| Write one test case | Write all tests |\n\n## Step Types\n\n### Setup Step\n```markdown\n**Files**: Create: `src/components/ProfileCard.tsx`\n**Action**: Create file with basic structure\n**Verify**: `npx tsc --noEmit` → No errors\n````\n\n### Implementation Step\n\n```markdown\n**Files**: Modify: `src/components/ProfileCard.tsx:L8-L10`\n**Action**: Implement header section with Avatar and name\n**Verify**: `npm run dev` → Component renders correctly\n```\n\n### Test Step\n\n```markdown\n**Files**: Create: `src/components/__tests__/ProfileCard.test.tsx`\n**Action**: Write unit test for profile name rendering\n**Verify**: `npm test ProfileCard` → 1 test passed\n```\n\n## Standalone Task File Template\n\nFor MODE B, use this complete template:\n\n```markdown\n# Task: [Task Name]\n\n> **File**: `standalone-{task-name}.md`\n> **Type**: feature | bugfix | improvement\n> **Source**: standalone\n> **Created**: YYYY-MM-DD\n> **Status**: pending\n\n## Description\n\n[Clear, concise description of what needs to be done]\n\n## Context\n\n- Standalone task (not part of a story)\n- [Any relevant background or motivation]\n- [References to related components or files]\n\n## Acceptance Criteria\n\n- [ ] Criterion 1\n- [ ] Criterion 2\n- [ ] Tests pass\n\n## Scope\n\n**Files to create/modify:**\n\n- Modify: `src/components/LoginButton.tsx`\n\n**Key changes:**\n\n- Update hover state styles\n- Ensure accessibility\n\n## Implementation Steps\n\n[Detailed atomic steps as described above]\n\n---\n\n## Notes\n\n[Any additional technical notes or considerations]\n\n## Related Tasks\n\n- Related to: [If any]\n```\n\n## Key Rules\n\n- ALWAYS include verification command for each step\n- MUST keep steps to 2-5 minutes of work\n- MUST save to docs/reference/backend/tasks/ directory\n- NEVER combine multiple actions into one step\n- Do NOT include commit step in plan (commits happen during execution)\n- MODE A: Preserve all existing content, only add/update steps\n- MODE B: Generate complete, self-contained task file\n\n## Common Mistakes\n\n- ❌ Steps too large → ✅ One action per step\n- ❌ Skip verification → ✅ Every step has verify command\n- ❌ Vague actions → ✅ Include exact code\n- ❌ Not saving to file → ✅ Always save task file\n- ❌ Including commit in steps → ✅ Commits happen during execution, not planning\n- ❌ MODE A: Overwriting existing content → ✅ Only update Implementation Steps section\n- ❌ MODE B: Missing metadata → ✅ Include all template sections\n"
        }
      ]
    },
    {
      "name": "implement",
      "files": [
        {
          "path": "skills/implement/SKILL.md",
          "type": "skill",
          "content": "---\nname: aico-backend-implement\ndescription: |\n  Execute backend task implementation with TDD. Read task file, execute steps, verify each, update status.\n\n  Use this skill when:\n  - User asks to \"implement task/plan\", \"start implementation\", \"execute plan\", or \"start coding\"\n  - Have task file (story-* or standalone-*) ready to execute\n  - User asks to \"use TDD\", \"write test first\", or \"test-driven\"\n  - User asks to \"write tests\", \"add tests\", \"create tests\"\n  - Fixing bugs (write failing test first)\n\n  TDD Iron Law: NO PRODUCTION CODE WITHOUT A FAILING TEST FIRST\n  TDD Cycle: RED (failing test) → Verify fails → GREEN (minimal code) → Verify passes → REFACTOR\n\n  Prerequisites:\n  - Task file in docs/reference/backend/tasks/ (story-* or standalone-*)\n  - Read constraints.md and design spec before coding\n\n  Flow: Read Task → Read Constraints → Execute Steps → Verify → Test → Update Status\n---\n\n# Implement\n\n## Language Configuration\n\nBefore generating any content, check `aico.json` in project root for `language` field to determine the output language. If not set, default to English.\n\n## Process\n\n0. **Read task file** (MANDATORY):\n   - Look for task file in `docs/reference/backend/tasks/`\n   - Accept either:\n     - **Story-based**: `story-{story-name}.md` with task number\n     - **Standalone**: `standalone-{task-name}.md` with task number\n   - User must specify task number (e.g., \"implement story-user-api Task 1\" or \"implement standalone-fix-auth Task 1\")\n   - Both formats contain multiple tasks, just different naming\n   - If NOT exists or task number not specified → STOP and ask user which task to implement\n\n1. **Read constraints FIRST** (before any code):\n   - `docs/reference/backend/design-system.md` - Colors, typography, spacing\n   - `docs/reference/backend/constraints.md` - Tech stack, patterns\n   - If task references design: `docs/reference/backend/designs/{name}.md`\n\n2. **Execute implementation steps**:\n   - Read \"Implementation Steps\" section from task\n   - Execute each step in order\n   - Run verification command after each step\n   - If fail → fix before proceeding\n   - If pass → continue to next step\n\n3. **After all steps**:\n   - Run unit tests\n   - Run build check\n\n4. **Update task status**:\n   - Update the specific task section in the file\n   - Mark acceptance criteria checkboxes: `- [ ]` → `- [x]`\n   - Change Status from `pending` to `completed`\n   - Update \"Progress\" section at bottom of file\n   - Both story-based and standalone files use the same format\n\n5. **Notify completion**:\n   - Show task file path and task number\n   - Show completion status\n   - **Check related Story** (story-based only):\n     - Read `> **Story**:` field from file header\n     - If Story exists, check story file at `docs/reference/pm/stories/`\n     - Update Story's Related Tasks section: mark this task as `- [x]`\n     - Count total vs completed tasks\n     - If all tasks completed, show: \"✅ All tasks completed! Story {story-name} is ready for acceptance.\"\n     - If partial completion, show: \"⏳ Progress: X/Y tasks completed\"\n\n## Task File Format\n\nBoth story-based and standalone tasks use the same file structure - the only difference is the filename:\n\n- **Story-based**: `story-{story-name}.md` (from PM story breakdown)\n- **Standalone**: `standalone-{task-name}.md` (from plan/ad-hoc requirements)\n\n**Unified File Structure:**\n\n```markdown\n# Story Tasks: User API\n# (or for standalone: # Standalone Tasks: Fix Auth Issues)\n\n> **Story**: docs/reference/pm/stories/user-api.md (story-based only)\n> **Role**: backend\n> **Created**: YYYY-MM-DD\n> **Updated**: YYYY-MM-DD\n\n---\n\n## Task 1: Define Types\n\n> **Status**: pending | in_progress | completed\n> **Type**: setup\n> **Depends on**: -\n\n### Description\n\n...\n\n### Acceptance Criteria\n\n- [ ] Criterion 1\n- [ ] Criterion 2\n\n### Implementation Steps\n\n#### Step 1: [Action]\n\n**Files**: ...\n**Action**: ...\n**Verify**: ...\n\n---\n\n## Task 2: Database Schema\n\n> **Status**: pending\n> **Type**: feature\n> **Depends on**: Task 1\n\n...\n\n---\n\n## Progress\n\n- Total tasks: 6\n- Completed: 0\n- In progress: 0\n- Pending: 6\n\n**Next task**: Task 1: Define Types\n```\n\n**Usage Examples:**\n- Story-based: `implement story-user-api Task 1`\n- Standalone: `implement standalone-fix-auth Task 1`\n\n## Execution Flow\n\n```\nRead Task File\n     ↓\nRead Constraints (design-system.md, constraints.md, designs/)\n     ↓\nExecute Step 1 → Verify → Pass? → Continue\n                      ↓\n                     Fail → Fix → Retry\n     ↓\nExecute Step 2 → Verify → Pass? → Continue\n     ↓\n     ...\n     ↓\nRun Unit Tests\n     ↓\nRun Build Check\n     ↓\nUpdate Task File (mark AC completed, update status)\n     ↓\nShow Completion Summary\n```\n\n## Step Execution Rules\n\n### Rule 1: Follow Constraints Exactly\n\n```tsx\n// ❌ Wrong: Ignore design system\n<button className=\"bg-blue-500 text-white\">\n\n// ✅ Right: Use design tokens\n<button className=\"bg-primary text-primary-foreground\">\n```\n\n### Rule 2: Verify Before Proceeding\n\nEach step has a Verify section - MUST run it and confirm expected output before moving on.\n\n### Rule 3: No Skipping\n\n- Execute ALL steps in order\n- Do NOT combine steps\n- Do NOT skip verification\n\n## Post-Implementation Checklist\n\n1. **Run tests**: `npm test [component]`\n2. **Run build**: `npm run build`\n3. **Update task file**:\n   - Mark AC checkboxes: `- [x]`\n   - Update Status: `completed`\n4. **Show completion summary** to user\n\n## Error Handling\n\n| Error Type           | Action                                 |\n| -------------------- | -------------------------------------- |\n| TypeScript error     | Fix type issues, re-verify             |\n| Test failure         | Debug test, fix implementation or test |\n| Build failure        | Check imports, fix errors              |\n| Constraint violation | Re-read constraints, align code        |\n\n## Updating Task File\n\nAfter successful implementation, update the task file. Both story-based and standalone files use the same format, so the update process is identical:\n\n**1. Mark Task's Acceptance Criteria as Completed**\n\n```markdown\n## Task 1: Define Types\n\n> **Status**: completed ← Changed from pending\n\n### Acceptance Criteria\n\n- [x] Types defined correctly ← Changed from [ ]\n- [x] Exported from index ← Changed from [ ]\n- [x] No type errors ← Changed from [ ]\n```\n\n**2. Update Progress Section**\n\n```markdown\n## Progress\n\n- Total tasks: 6\n- Completed: 1 ← Changed from 0\n- In progress: 0\n- Pending: 5 ← Changed from 6\n\n**Next task**: Task 2: Database Schema ← Update this\n```\n\n**3. Update Story File Checkboxes (story-based only)**\n\nIf this is a story-based task, update the PM story file at `docs/reference/pm/stories/`:\n\n```markdown\n### Backend Tasks\n\n- [x] Task 1: Define Types ← Changed from [ ]\n- [ ] Task 2: Database Schema\n- [ ] Task 3: Repository Layer\n```\n\n## Key Rules\n\n- ALWAYS read task file first\n- ALWAYS read all constraint files before writing any code\n- MUST run verification command for each step\n- ALWAYS run tests before marking task complete\n- MUST update task file (mark AC, update status)\n\n## Common Mistakes\n\n- ❌ Start without reading task file → ✅ ALWAYS read task file first\n- ❌ Skip reading constraints → ✅ ALWAYS read before coding\n- ❌ Skip verification → ✅ Run verify command for each step\n- ❌ Skip tests → ✅ Run tests before marking complete\n- ❌ Forget to update task file → ✅ Update AC and status\n\n---\n\n## TDD Deep Dive\n\n### The TDD Iron Law\n\n```\nNO PRODUCTION CODE WITHOUT A FAILING TEST FIRST\n```\n\nWrite code before the test? **Delete it. Start over.**\n\n### Red-Green-Refactor Cycle\n\n```\nRED → Verify Fails → GREEN → Verify Passes → REFACTOR → Repeat\n```\n\n#### 1. RED - Write Failing Test\n\n```typescript\ntest('Button shows loading state when clicked', async () => {\n  render(<SubmitButton onClick={mockSubmit} />)\n  await userEvent.click(screen.getByRole('button'))\n  expect(screen.getByRole('button')).toBeDisabled()\n  expect(screen.getByTestId('spinner')).toBeInTheDocument()\n})\n```\n\n#### 2. Verify RED - Watch It Fail\n\n```bash\nnpm test -- --watch ComponentName\n```\n\n#### 3. GREEN - Write Minimal Code\n\nWrite simplest code to pass the test. Don't add features not in test.\n\n#### 4. Verify GREEN - Watch It Pass\n\n#### 5. REFACTOR - Clean Up\n\nOnly after green. Keep tests passing.\n\n### Testing Library Query Priority\n\n1. `getByRole` - accessible by everyone\n2. `getByLabelText` - form fields\n3. `getByText` - non-interactive elements\n4. `getByTestId` - last resort\n\n### Test Coverage Requirements\n\n| Component Type | Required Tests                   |\n| -------------- | -------------------------------- |\n| UI Component   | Render, props, variants          |\n| Form           | Validation, submit, error states |\n| Interactive    | User events, callbacks           |\n| Data Display   | Loading, error, empty states     |\n\n### TDD Red Flags - STOP and Start Over\n\n- Code before test\n- Test passes immediately\n- Testing implementation details\n- `querySelector` everywhere\n\n---\n\n## Example Workflow\n\n```bash\n# User: \"Implement story-user-profile-2-header\"\n\n1. ✓ Read task: docs/reference/backend/tasks/story-user-profile-2-header.md\n2. ✓ Read constraints:\n   - design-system.md\n   - constraints.md\n   - designs/user-profile.md\n\n3. ✓ Execute Step 1: Create component file\n   → Run: npm run typecheck\n   → ✓ Pass\n\n4. ✓ Execute Step 2: Implement header layout\n   → Run: npm run dev\n   → ✓ Pass\n\n5. ✓ Execute Step 3: Add responsive styles\n   → Run: npm run dev (test at different breakpoints)\n   → ✓ Pass\n\n6. ✓ Execute Step 4: Add unit tests\n   → Run: npm test LoginHeader\n   → ✓ 3 tests passed\n\n7. ✓ Run full test suite\n   → Run: npm test\n   → ✓ All tests passed\n\n8. ✓ Run build\n   → Run: npm run build\n   → ✓ Build successful\n\n9. ✓ Update task file:\n   - Marked all AC as completed\n   - Status: completed\n\n10. ✓ Task completed!\n```\n\n## Iron Law\n\n**NO CODE WITHOUT TASK FILE**\n\nThis rule is non-negotiable. Before writing code:\n\n1. Task file must exist\n2. Acceptance criteria must be defined\n3. Implementation steps must be clear\n\n### Rationalization Defense\n\n| Excuse                         | Reality                                     |\n| ------------------------------ | ------------------------------------------- |\n| \"It's a simple change\"         | Simple changes often have hidden complexity |\n| \"I'll document after coding\"   | Post-hoc documentation is always incomplete |\n| \"Tests can wait until later\"   | Untested code is broken code                |\n| \"I know what needs to be done\" | Assumptions without validation cause bugs   |\n"
        }
      ]
    }
  ],
  "commands": [
    {
      "name": "init",
      "files": [
        {
          "path": "commands/init.md",
          "type": "command",
          "content": "---\ndescription: Initialize backend constraints file for the project\n---\n\n# Initialize Backend Environment\n\nSet up the backend development environment by creating the constraints file.\n\n## Skills Used\n\n- `aico-backend-init` - Initialize backend environment with constraints template\n\n## Document Header Format\n\nAll generated documents MUST use this unified header format:\n\n```markdown\n# [Document Title]\n\n> Project: [project-name]\n> Created: YYYY-MM-DD\n> Last Updated: YYYY-MM-DD\n```\n\n## Steps\n\n1. **Check existing constraints**\n   - Look for `docs/reference/backend/constraints.md`\n   - If exists, ask user if they want to overwrite or skip\n\n2. **Create directory structure**\n\n   ```\n   docs/reference/backend/\n   ├── constraints.md      # Backend constraints (from template)\n   └── tasks/              # Task tracking directory\n   ```\n\n3. **Generate constraints file**\n   - Guide user through key decisions:\n     - Language/Runtime (Node.js, Python, Go, etc.)\n     - Framework (Express, FastAPI, Gin, etc.)\n     - Database (PostgreSQL, MongoDB, etc.)\n     - ORM/Query builder\n     - Testing framework\n     - API style (REST, GraphQL, gRPC)\n\n4. **Validate setup**\n   - Confirm constraints file created\n   - Confirm tasks directory exists\n\n## Output\n\n```\n✓ Created docs/reference/backend/constraints.md\n✓ Created docs/reference/backend/tasks/\n✓ Backend environment initialized\n```\n"
        }
      ]
    },
    {
      "name": "tasks",
      "files": [
        {
          "path": "commands/tasks.md",
          "type": "command",
          "content": "---\ndescription: Break down a PM story into backend tasks\n---\n\n# Break Down Story into Backend Tasks\n\nConvert a PM story/PRD into actionable backend tasks with progress tracking.\n\n## Usage\n\n```\n/backend.tasks [story-name]\n```\n\n## Arguments\n\n- `story-name` (optional): Name of the story to break down\n  - If not provided, list available stories and ask user to select\n\n## Steps\n\n1. **Locate story**\n   - Search in `docs/reference/pm/stories/`\n   - Search in `docs/reference/pm/versions/`\n   - If story-name provided, find matching file\n   - If not provided, list available stories for selection\n\n2. **Invoke task-breakdown skill**\n   - Use `aico-backend-task-breakdown` skill\n   - Read story/PRD content\n   - Analyze backend requirements\n   - Decompose into tasks following layered architecture\n\n3. **Create task file**\n   - Output to `docs/reference/backend/tasks/[story-name].md`\n   - Include progress tracking table\n   - Define each task with acceptance criteria\n\n## Output\n\n```\n✓ Found story: [story-name]\n✓ Analyzed backend requirements\n✓ Created docs/reference/backend/tasks/[story-name].md\n\nTasks created:\n1. Define data models (⏳ pending)\n2. Create database migrations (⏳ pending)\n3. Implement repository layer (⏳ pending)\n...\n```\n"
        }
      ]
    },
    {
      "name": "plan",
      "files": [
        {
          "path": "commands/plan.md",
          "type": "command",
          "content": "---\ndescription: Create atomic implementation plan for a backend task\n---\n\n# Create Implementation Plan\n\nConvert a single backend task into atomic 2-5 minute implementation steps.\n\n## Usage\n\n```\n/backend.plan [task-number]\n```\n\n## Arguments\n\n- `task-number` (optional): Task number from the task list\n  - If not provided, show current task list and ask user to select\n\n## Prerequisites\n\n- Task file exists at `docs/reference/backend/tasks/[story].md`\n- Constraints file exists at `docs/reference/backend/constraints.md`\n\n## Steps\n\n1. **Locate task**\n   - Read task file from `docs/reference/backend/tasks/`\n   - If task-number provided, find that task\n   - If not provided, show pending tasks for selection\n\n2. **Read constraints**\n   - Load `docs/reference/backend/constraints.md`\n   - Understand tech stack, patterns, conventions\n\n3. **Invoke plan skill**\n   - Use `aico-backend-plan` skill\n   - Break task into atomic steps (2-5 minutes each)\n   - Each step includes:\n     - Files to create/modify\n     - Exact action to take\n     - Verification command\n\n4. **Save plan to file**\n   - Save to `docs/reference/backend/plans/{story}-task-{number}.md`\n   - Present summary and next steps to user\n\n## Output\n\n```markdown\n# [Task Name] - Implementation Plan\n\n> Project: [project-name]\n> Created: YYYY-MM-DD\n> Task: [task description]\n\n## Step 1: Define types\n\n**Files**: Create `src/types/user.ts`\n**Action**: [code snippet]\n**Verify**: `npx tsc --noEmit` → No errors\n\n## Step 2: Write failing test\n\n**Files**: Create `src/services/__tests__/user.test.ts`\n**Action**: [test code]\n**Verify**: `npm test user.test.ts` → 1 failing test\n\n...\n\n**Note**: The plan is saved to `docs/reference/backend/plans/{story}-task-{number}.md`\n\nReady to implement? Review the plan file, then use the `aico-backend-implement` skill to execute this plan.\n```\n"
        }
      ]
    }
  ],
  "docs": [],
  "dependencies": [
    "@the-aico/_shared/code-review",
    "@the-aico/_shared/subagent-driven",
    "@the-aico/_shared/worktree"
  ]
}
